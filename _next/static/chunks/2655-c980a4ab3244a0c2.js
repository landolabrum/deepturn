"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2655],{22655:function(e,t,n){n.d(t,{Z:function(){return w}});var i=n(16835),a=n(21378),s=n.n(a),o=n(67294),r=n(60409),c=[".d-flex.jsx-1290947072,.authentication.jsx-1290947072 .authentication__view-header.jsx-1290947072,.d-flex-col.jsx-1290947072,.authentication.jsx-1290947072 .authentication__view-action.jsx-1290947072,.authentication__welcome-modal.jsx-1290947072,.authentication.jsx-1290947072,.authentication__status--success.jsx-1290947072{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;width:100%;}","a.jsx-1290947072{-webkit-text-decoration:none !important;text-decoration:none !important;}",".d-flex-col.jsx-1290947072,.authentication.jsx-1290947072 .authentication__view-action.jsx-1290947072,.authentication__welcome-modal.jsx-1290947072,.authentication.jsx-1290947072,.authentication__status--success.jsx-1290947072{-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}",".authentication__status.jsx-1290947072{margin:var(--s-element) auto;}",".authentication__status--success.jsx-1290947072{gap:var(--s-4);width:inherit;text-align:center;color:var(--dark);}",".authentication__status--success--header.jsx-1290947072{font-size:var(--s-3);}",".authentication.jsx-1290947072{min-height:350px;z-index:1;height:-webkit-max-content;height:-moz-max-content;height:max-content;overflow:hidden;gap:var(--s-4);}","@media (max-width:900px){.authentication.jsx-1290947072{min-width:unset;}}",".authentication__welcome-modal.jsx-1290947072{width:100%;-webkit-align-items:flex-start;-webkit-box-align:flex-start;-ms-flex-align:flex-start;align-items:flex-start;gap:var(--s-9);}",".authentication__welcome-modal.jsx-1290947072 h1.jsx-1290947072{line-height:1;margin-bottom:var(--s-1);}",".authentication__email-verify.jsx-1290947072{font-size:var(--s-5);min-height:500px;}",".authentication.jsx-1290947072 .authentication__view-header.jsx-1290947072{height:var(--s-element);text-transform:capitalize;-webkit-box-pack:start;-webkit-justify-content:flex-start;-ms-flex-pack:start;justify-content:flex-start;gap:var(--s-10);font-weight:100;font-family:Game;text-transform:uppercase;line-height:var(--s-1);font-size:var(--s-3);--ui-icon-size:var(--s-1);--ui-icon-color:var(--gray-70);color:var(--gray-70);}","@media (max-width:1100px){.authentication.jsx-1290947072 .authentication__view-header.jsx-1290947072{width:100%;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;}}",".authentication.jsx-1290947072 .authentication__view-action.jsx-1290947072{background-color:inherit;white-space:nowrap;text-align:center;gap:var(--s-4);color:var(--gray-60);position:relative;z-index:1;}",".authentication.jsx-1290947072 .authentication__view-action.jsx-1290947072 .authentication__view-label.jsx-1290947072{padding:0 var(--s-8);z-index:2;margin:var(--s-4) 0 0;background-color:inherit;width:100%;}"];c.__hash="1290947072";var l=n(55140),u=n(20226),d=n(49334),h=n(11163),x=n(10577),m=n(41664),f=n.n(m),v=n(23992),p=n(36946),_=n(27834),g=n(11907),j=n(85893),w=function(e){var t=(0,o.useState)(),n=t[0],a=t[1],m=(0,o.useState)((null==e?void 0:e.view)||"sign-in"),w=m[0],b=m[1],k=(0,o.useState)(!1),y=k[0],P=k[1],S=(0,h.useRouter)(),O=S.query,N=(0,p.dd)(),Z=N.openModal,E=N.closeModal,C=(0,_.lm)(),z=(0,i.Z)(C,2),R=(z[0],z[1]),D=function(e){var t=null==e?void 0:e.status;if(!t){alert("dev, handle this! 212");return}var n="404, an error occured signing up. ";switch(t){case"created":n="email: ".concat(null==e?void 0:e.email,", successfully created.");break;case"existing":n="email: ".concat(null==e?void 0:e.email,", exists.")}R({active:!0,list:[{label:n,message:"Sign in to continue."}]}),b("sign-in"),a(e.email)},U=function(e){null!=e&&e.id&&Z({title:"User Details",children:(0,j.jsx)(function(e){var t=e.user,n=e.onClose,i=(0,g.d)()>9,a=function(e){e&&i&&S.push("/admin")};return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(s(),{id:c.__hash,children:c}),(0,j.jsxs)("div",{className:"jsx-".concat(c.__hash)+" authentication__welcome-modal",children:[(0,j.jsxs)("h3",{className:"jsx-".concat(c.__hash),children:["Welcome, ",t.name]}),i&&(0,j.jsx)(x.Z,{onClick:a,children:"admin"}),(0,j.jsx)(x.Z,{onClick:a,children:"account"}),(0,j.jsx)(x.Z,{onClick:n,children:"Close"})]})]})},{user:e,onClose:E})})};return(0,o.useEffect)(function(){O&&O.verify&&"verify"!==w&&b("verify"),void 0!=n&&b("sign-in")},[D,U]),(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(s(),{id:c.__hash,children:c}),(0,j.jsxs)("div",{className:"jsx-".concat(c.__hash)+" "+"authentication ".concat("sign-in"==w?" authentication__sign-in":""),children:[(0,j.jsxs)("div",{className:"jsx-".concat(c.__hash)+" authentication__view-header",children:[(0,j.jsx)("div",{className:"jsx-".concat(c.__hash)+" authentication__logo",children:(0,j.jsx)(l.a,{icon:"".concat(v.Z.merchant.name,"-logo")})}),(0,j.jsx)("div",{className:"jsx-".concat(c.__hash)+" authentication__view-name",children:(0,d.Z)(w)})]}),w.includes("@")&&(0,j.jsxs)("div",{className:"jsx-".concat(c.__hash)+" authentication__email-verify",children:["An email has been sent to",(0,j.jsx)(f(),{onMouseEnter:function(){return P(!0)},onMouseLeave:function(){return P(!1)},style:y?{color:"var(--primary"}:void 0,href:"mailto://".concat(w),children:" "+w+", "})," click the link in the email to continue."]}),"sign-in"==w&&(0,j.jsx)(r.Z,{email:n,onSuccess:U}),"sign-up"==w&&(0,j.jsx)(u.Z,{onSuccess:D}),(0,j.jsxs)("div",{className:"jsx-".concat(c.__hash)+" authentication__view-action",children:[(0,j.jsxs)("div",{className:"jsx-".concat(c.__hash)+" authentication__view-label",children:["sign-in"==w&&"no account?","sign-up"==w&&"already have an account?"]}),(0,j.jsxs)(x.Z,{onClick:function(){switch(w){case"sign-in":default:b("sign-up");break;case"sign-up":case"customer-created":case"existing":b("sign-in")}},variant:"link",children:["sign-in"==w&&"Sign Up","sign-up"==w&&"Login"]})]})]})]})}},20226:function(e,t,n){n.d(t,{Z:function(){return S}});var i=n(27812),a=n(59499),s=n(50029),o=n(16835),r=n(21378),c=n.n(r),l=n(64687),u=n.n(l),d=n(67294),h=[".sign-up.jsx-2918039913{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;-webkit-align-content:center;-ms-flex-line-pack:center;align-content:center;width:100%;}",".sign-up.jsx-2918039913 .sign-up__forgot-password-link.jsx-2918039913{color:var(--blue);cursor:pointer;}",".sign-up.jsx-2918039913 .sign-up__forgot-password-link.jsx-2918039913:hover{-webkit-filter:brightness(1.3);filter:brightness(1.3);}",".sign-up__login.jsx-2918039913{margin-top:var(--s-4);width:100%;}",".authentication__authentication-status.jsx-2918039913{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;height:auto;}"];h.__hash="2918039913";var x=n(11907),m=n(10394),f=n(99980),v=n(75839),p=n(49334),_=n(98014),g=n(27834),j=n(23992),w=n(85893);function b(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,i)}return n}function k(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?b(Object(n),!0).forEach(function(t){(0,a.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):b(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var y=[{name:"first_name",label:"first name",placeholder:"first name",required:!0,width:"50%"},{name:"last_name",label:"last name",placeholder:"last name",required:!0,width:"50%"},{name:"email",type:"email",label:"email",placeholder:"your@email.com",required:!0}],P=[{name:"password",label:"password",type:"password",placeholder:"password",required:!0},{name:"confirm_password",label:"confirm password",type:"password",placeholder:"confirm password",required:!0}],S=function(e){var t,n=e.hasPassword,a=void 0===n||n,r=e.btnText,l=e.onSuccess,b=e.title,S=(0,g.lm)(),O=(0,o.Z)(S,2);O[0],O[1];var N=(0,d.useState)(!1),Z=N[0],E=N[1],C=(0,x.a)(),z=(0,m.ko)("IMemberService"),R=(0,f.Z)(),D=(0,d.useState)(y),U=D[0],q=D[1],L=function(e,t,n){return q(U.map(function(i){return(null==i?void 0:i.name)==e&&(delete i.error,i[t]=n),i})),!0},M=function(){var e=!1;return U.forEach(function(t){var n,i=null==t?void 0:t.name,a=(0,p.Z)(i),s=null==t?void 0:t.value,o=null==s?void 0:s.length,r="".concat(a,", is not long enough"),c="".concat(a,", is not long enough");if(s)switch(i){case"first_name":case"last_name":o<3?e=L(i,"error",r):o>20&&(e=L(i,"error",c));break;case"email":s&&!s.includes("@")?e=L(i,"error","".concat(a,', missing "@"')):s&&!s.includes(".")&&(e=L(i,"error","".concat(a,', missing "."')));break;case"password":var l=null===(n=U.find(function(e){return"confirm_password"==e.name}))||void 0===n?void 0:n.value;o<3?e=L(i,"error",r):o>20&&(e=L(i,"error",c)),s!=l&&(e=L(i,"error","Passwords don't match"),e=L("confirm_password","error","Passwords don't match"))}else e=L(i,"error","".concat(a,", can't be empty"))}),e},G=(t=(0,s.Z)(u().mark(function e(){var t,n,i,a,s,o,r,c,d,h,x;return u().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(E(!0),t=M()){e.next=16;break}return c={name:"".concat(null===(n=(0,_.P)(U,"first_name"))||void 0===n?void 0:n.value," ").concat(null===(i=(0,_.P)(U,"first_name"))||void 0===i?void 0:i.value),email:null===(a=(0,_.P)(U,"email"))||void 0===a?void 0:a.value,phone:null===(s=(0,_.P)(U,"phone"))||void 0===s?void 0:s.value,address:null===(o=(0,_.P)(U,"address"))||void 0===o?void 0:o.value,metadata:{user:{user_agent:R,password:null===(r=(0,_.P)(U,"password"))||void 0===r?void 0:r.value},merchant:j.Z.merchant}},e.prev=4,e.next=7,z.signUp(c);case 7:(null==(d=e.sent)?void 0:d.email)!==void 0?l&&l(d):(null==d?void 0:d.status)==="existing"&&l?l(k(k({},d),{},{email:null===(h=(0,_.P)(U,"email"))||void 0===h?void 0:h.value})):console.error("[ SIGN UP RESPONSE UNHANDLED ]",d),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(4),null!==e.t0&&void 0!==e.t0&&null!==(x=e.t0.detail)&&void 0!==x&&x.fields?(console.log("[ e.detail.fields ]",e.t0.detail.fields),e.t0.detail.fields.forEach(function(e){L(e.name,"error",e.message)})):console.error("[ SIGN UP RESPONSE ERRORS ]",e.t0);case 14:e.next=17;break;case 16:console.error("[ SIGN UP ERRORS LOCAL ]",t);case 17:E(!1);case 18:case"end":return e.stop()}},e,null,[[4,11]])})),function(){return t.apply(this,arguments)});return(0,d.useEffect)(function(){a&&q([].concat((0,i.Z)(U),P))},[]),(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(c(),{id:h.__hash,children:h}),!C&&(0,w.jsx)(v.Z,{title:b,fields:U,onSubmit:G,loading:Z,onChange:function(e){var t=e.target;L(t.name,"value",t.value)},submitText:r||"sign up"}),(0,w.jsx)("div",{className:"jsx-".concat(h.__hash)+" authentication__authentication-status",children:null==Z?void 0:Z.message})]})}}}]);